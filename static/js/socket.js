// Generated by CoffeeScript 1.7.1
angular.module('socket', []).factory('socket', function($rootScope) {
  var root_url, socket, socket_url;
  root_url = /\/\/([^/]*)\/?/.exec(document.URL)[1];
  socket_url = "ws://" + root_url + "/";
  socket = new WebSocket(socket_url);
  return {
    onmessage: function(callback) {
      return socket.onmessage = function(message) {
        return $rootScope.$apply(function() {
          return callback(JSON.parse(message.data));
        });
      };
    },
    send: function(message) {
      return socket.send(JSON.stringify(message));
    }
  };
});
