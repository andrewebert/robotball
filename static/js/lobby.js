// Generated by CoffeeScript 1.7.1
var app;

app = angular.module('lobbyApp', ['socket']);

app.controller('LobbyCtrl', [
  '$scope', 'socket', function($scope, socket) {
    $scope.id = void 0;
    $scope.gotPlayers = false;
    $scope.players = [];
    socket.onmessage(function(data) {
      var method, player;
      console.log(data);
      method = data.method;
      if (method === 'setId') {
        $scope.id = data.userId;
      } else if (method === 'setPlayers') {
        $scope.players = data.players;
        $scope.gotPlayers = true;
      } else if (method === 'addPlayer') {
        if ($scope.gotPlayers) {
          $scope.players.push({
            userId: data.userId,
            name: data.name
          });
        }
      } else if (method === 'removePlayer') {
        $scope.players = (function() {
          var _i, _len, _ref, _results;
          _ref = $scope.players;
          _results = [];
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            player = _ref[_i];
            if (player.userId !== data.userId) {
              _results.push(player);
            }
          }
          return _results;
        })();
      } else if (method === 'startGame') {
        console.log("Started game with " + data.opponent);
      }
    });
    $scope.startGame = function(opponentId) {
      return socket.send({
        method: "startGame",
        opponent: opponentId
      });
    };
    return $scope.setUsername = function(username) {
      return socket.send({
        method: "setName",
        name: username
      });
    };
  }
]);
